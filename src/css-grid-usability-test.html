<html>

<body>
    <div id="container">
        <div contenteditable spellcheck="false" id="selector"></div>
        <div class="cell" contenteditable spellcheck="false" style="position: sticky;top: 0;background: beige;"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false">
            <div style="font-style: italic;"> celll </div>
        </div>
        <div class="cell" contenteditable spellcheck="false"> 
            <div style="font-style: italic;"> celll </div>
         </div>
        <div class="cell custom-border" contenteditable spellcheck="false"> celll </div>
        <div class="cell custom-border" contenteditable spellcheck="false"> celll </div>
        <div class="cell custom-border" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"
            style="box-shadow: 2px 0 0 0 #c60202, 0 2px 0 0 #b92020, 2px 2px 0 0 #d20a0a, 2px 0 0 0 #b30000 inset, 0 2px 0 0 #b51515 inset;z-index: 2;"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="merged-cells">
            <div class="cell" contenteditable spellcheck="false"> celll </div>
            <div class="cell" contenteditable spellcheck="false"> celll </div>
        </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="nested-grid">
            <div class="cell" contenteditable spellcheck="false"> celll </div>
            <div class="cell" contenteditable spellcheck="false"> celll </div>
            <div class="cell" contenteditable spellcheck="false"> celll </div>
            <div class="cell" contenteditable spellcheck="false"> celll </div>
            <div class="cell" contenteditable spellcheck="false"> celll </div>
            <div class="cell" contenteditable spellcheck="false"> celll </div>
        </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
        <div class="cell" contenteditable spellcheck="false"> celll </div>
    </div>
</body>

<style>
    #container {
        display: grid;
        grid-template-columns: 10px 10px 10px 10px 10px 10px 100px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px 10px;
        grid-template-rows: 40px 20px 40px 40px 40px;
        cursor: default;
    }

    .cell {
        box-shadow: 0.25px 0 0 0 #dedbd7, /* right */
            0 0.25px 0 0 #dedbd7, /* bottom */
            0.25px 0.25px 0 0 #dedbd7, /* bottom-right corner */
            0.25px 0 0 0 #dedbd7 inset, /* left inset */
            0 0.25px 0 0 #dedbd7 inset; /* top inset */
        overflow: hidden;
        padding: 2px;
        margin-left: 0.25px;
        margin-top: 0.25px;
    }

    .cell:focus {
        outline: none;
    }

    .merged-cells {
        display: grid;
        grid-column-start: span 2;
        grid-row-start: span 2;
        background-color: #dedbd7;
        box-shadow: 1px 0 0 0 #dedbd7, /* right */
            0 1px 0 0 #dedbd7, /* bottom */
            1px 1px 0 0 #dedbd7, /* bottom-right corner */
            1px 0 0 0 #dedbd7 inset, /* left inset */
            0 1px 0 0 #dedbd7 inset; /* top inset */
    }

    .merged-cells .cell {
        box-shadow: none !important;
    }

    .nested-grid {
        display: grid;
        grid-column-start: span 3;
        grid-row-start: span 2;
        grid-template-columns: 5px 6px 19px;
        grid-template-rows: 20px 60px 40px;
    }

    #selector {
        padding: 0px;
        z-index: 100;
        border: 0.5px solid salmon;
        font-size: 3px;
        background: #d99494aa;
        position: absolute;
        top: 0;
        left: 0;
        pointer-events: none;
    }

    .custom-border {
        box-shadow: 1.5px 0 0 0 black, /* right */
            0 1.5px 0 0 black, /* bottom */
            1.5px 1.5px 0 0 black, /* bottom-right corner */
            1.5px 0 0 0 black inset, /* left inset */
            0 1.5px 0 0 black inset; /* top inset */
        z-index: 10;
        margin-left: -2px !important;
        margin-top: -2px !important;
    }
</style>

<script>
    let f = function (e) {
        event.preventDefault();
        if(e.target.id == "container") {
            return;
        }
        selector = document.getElementById("selector");
        let bottomRight = e.target
        

        selector.style.width = bottomRight.offsetLeft - selector.offsetLeft + bottomRight.offsetWidth
        selector.style.height = bottomRight.offsetTop - selector.offsetTop + bottomRight.offsetHeight
    }

    document.getElementById("container").addEventListener('mousedown', function (event) {
        event.preventDefault();
        let topLeft = event.target;
        selector.style.left = topLeft.offsetLeft
        selector.style.top = topLeft.offsetTop
        selector.style.width = topLeft.offsetWidth
        selector.style.height = topLeft.offsetHeight

        document.getElementById("container").addEventListener('mousemove', f)
    })

    document.getElementById("container").addEventListener("dblclick", (event) => {
        event.target.style.overflow = 'visible'
        event.target.style.width = '100px'
        event.target.style.backgroundColor = 'white';
        event.target.style.zIndex = '5';
        event.target.focus();
    });

    document.getElementById("container").addEventListener('mouseup', function (e) {
        document.getElementById("container").removeEventListener('mousemove', f);
    })
</script>

</html>
